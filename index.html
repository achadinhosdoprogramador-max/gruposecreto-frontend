<!DOCTYPE html>
<html lang="pt-BR" style="--vh: 9px;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <title>游댠CLUBE SECRETO - WhatsApp Oficial</title>
    <link rel="icon" type="image/svg+xml" href="images/wicon.svg">
    <script async="" src="js/fbevents.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0; padding: 0; height: 100%; overflow: hidden;
            touch-action: manipulation; background-color: #0a0a0a;
        }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
        .message-bubble::before {
            content: ''; position: absolute; bottom: 0; left: -6px;
            width: 12px; height: 12px; background: var(--bubble-color, #171717);
            clip-path: polygon(100% 100%, 0 100%, 100% 0);
        }
        .typing-indicator { display: inline-block; transition: all 0.3s ease; }
        @keyframes typing { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
        .typing-animation { animation: typing 1s infinite; }
        input::placeholder { color: #807f7f; }
        @keyframes slideIn { 0% { transform: translateY(100%); } 100% { transform: translateY(0); } }
        .animate-slideIn { animation: slideIn 0.3s ease-out forwards; }
        .container-center {
            width: 100%; max-width: 100%; margin: 0 auto; height: 100vh;
            display: flex; flex-direction: column;
        }
        @media (min-width: 640px) {
            body { display: flex; justify-content: center; align-items: center; background-color: #1a1a1a; }
            .container-center { max-width: 500px; height: 100vh; border-radius: 0; box-shadow: 0 0 15px rgba(0, 0, 0, 0.3); }
        }
        @media (min-width: 1024px) {
            .container-center { max-width: 550px; height: 100vh; border-radius: 12px; overflow: hidden; }
        }
        .truncate-text {
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 180px;
        }
        @media (min-width: 640px) { .truncate-text { max-width: 300px; } }
        .media-responsive {
            max-width: 100%; max-height: 200px; width: auto; object-fit: contain;
        }
        @media (min-width: 640px) { .media-responsive { max-height: 250px; } }
        .payment-container { max-width: 100%; margin: 0 auto; }
        @media (min-width: 640px) { .payment-container { max-width: 500px; } }
        @media (min-width: 1024px) { .payment-container { max-width: 550px; border-radius: 12px; } }
        @media (max-height: 700px) { .qr-wrapper { transform: scale(0.9); transform-origin: center top; } }
        .loading-container { display: flex; align-items: center; justify-content: center; }
        .titulo-pix { font-size: 38px; font-weight: 700; text-align: center; color: #111111 !important; margin-bottom: 6px; margin-top: 10px; }
        .subtitulo-cronometro { font-size: 18px !important; font-weight: 500 !important; text-align: center !important; color: #282828 !important; margin-top: 10px !important; margin-left: 15px !important; margin-right: 15px !important; }
        .subtitulo-cronometro span#cronometro { font-weight: 600 !important; color: #d00000 !important; }
        .loading-wrapper {
            background-color: #FFF9C4; border-radius: 9999px; display: flex; justify-content: center;
            align-items: center; padding: 6px 16px; max-width: 500px; width: 100%; margin: 14px auto 23px auto;
        }
        .loading-text { font-size: 16px; font-weight: 500; color: #554F01; margin-right: 8px; margin-bottom: 2px; }
        .loading-icon {
            display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(0, 0, 0, 0.1);
            border-top: 2px solid #3A69D8; border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>

    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', 'seu_id'); 
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=seu_id&ev=PageView&noscript=1" /></noscript>
    </head>
<body>
    <div class="container-center bg-[#0a0a0a]" style="height: 100vh;">

        <script type="application/javascript" src="js/tag_gen.js" data-goal="SEU_GOAL_ID_AQUI"></script> <script type="application/javascript" src="js/tag_gen.js" data-goal="SEU_GOAL_ID_AQUI"></script> <div class="px-3 py-3 flex items-center bg-[#101010] shadow-sm">
            <div class="flex items-center gap-3 flex-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-[20px] h-[20px] text-[#f9f9f9]"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>
                <div class="w-[35px] h-[35px] rounded-full overflow-hidden">
                    <img src="images/IMG-20240711-00350743535.webp" alt="Group" class="w-full h-full object-cover">
                </div>
                <div class="flex-1 mt-2">
                    <h1 class="font-medium text-[14px] sm:text-[16px] leading-tight mb-[3px] text-[#f9f9f9]">游댠CLUBE SECRETO - LOCAL DESCONHECIDO </h1>
                    <p id="statusText" class="text-[10px] sm:text-[12px] leading-tight text-[#807f7f] truncate-text">+55 19 99554-7226, +55 19 99818-6442, +55 19 99892-9962</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4 sm:gap-5">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="w-[28px] h-[28px] sm:w-[32px] sm:h-[32px] stroke-[1.5] text-[#f9f9f9]"><path d="m22 8-6 4 6 4V8Z"></path><rect width="14" height="12" x="2" y="6" rx="2" ry="2"></rect></svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-[22px] h-[22px] sm:w-[24px] sm:h-[24px] text-[#f9f9f9]"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
            </div>
        </div>

        <div id="chatArea" class="flex-1 overflow-y-auto px-2 py-4 space-y-3 hide-scrollbar" style="background-image: url('images/fundo-dark.svg'); background-size: cover; background-position: center; background-repeat: no-repeat; background-color: #0a0a0a;">
            <div id="scroll-anchor"></div>
        </div>
  
        <div class="px-2 py-1.5 flex items-center gap-2 bg-[#101010]">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-[#f9f9f9]"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
            <div class="flex-1 rounded-lg px-3 py-1.5 bg-[#171717]">
                <input type="text" placeholder="Mensagem" class="w-full bg-transparent text-[15px] focus:outline-none text-[#f9f9f9] placeholder-[#807f7f]" value="" readonly>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-[#f9f9f9]"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path><circle cx="12" cy="13" r="3"></circle></svg>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-[#f9f9f9]"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg>
        </div>
    </div>

    <div id="payment-overlay" class="fixed inset-0 bg-black/80 backdrop-blur-[2px] z-40 hidden flex justify-center items-center">
        <div id="payment-panel" class="fixed bottom-0 left-0 right-0 z-50 w-full bg-white shadow-lg overflow-auto max-h-[100vh]">
            <div class="p-4 sm:p-6 relative overflow-hidden">
          
                <div id="payment-intro" class="flex flex-col items-center gap-5 sm:gap-6 animate-fadeIn">
                    <div class="w-16 h-16 sm:w-20 sm:h-20 rounded-2xl overflow-hidden border border-gray-200">
                        <img src="images/IMG-20240711-00350743535.webp" alt="游댠CLUBE SECRETO" class="w-full h-full object-cover">
                    </div>
                    <div class="text-center">
                        <h2 id="titulo-cidade" class="text-lg sm:text-xl font-semibold text-gray-800">游댠CLUBE SECRETO - LOCAL DESCONHECIDO</h2>
                        <p style="font-size: 14px; font-weight: 400;" class="text-gray-600 mt-1">Criado em 19/05/2025</p>
                        <div id="bloco-avatares" class="flex items-center justify-center -space-x-2 mt-2">
                            <div class="w-8 h-8 rounded-full border-2 border-white overflow-hidden">
                                <img src="images/IMG-20230920-204325646464.webp" alt="Participant" class="w-full h-full object-cover">
                            </div>
                            <div class="w-8 h-8 rounded-full border-2 border-white overflow-hidden">
                                <img src="images/1718211968653.webp" alt="Participant" class="w-full h-full object-cover">
                            </div>
                            <div class="w-8 h-8 rounded-full bg-gray-100 border-2 border-white flex items-center justify-center">
                                <span class="text-xs font-medium text-gray-600">+752</span>
                            </div>
                        </div>
                    </div>

                    <div class="my-4 text-center">
                        <span class="text-xl text-gray-500 line-through">de R$ 19,99</span>
                        <span class="text-4xl font-bold text-gray-900 ml-2">por R$ 9,99</span>
                        <p class="text-sm text-green-600 font-semibold mt-1">Oferta de Acesso Imediato!</p>
                    </div>
                    <div class="w-full flex flex-col items-center">
                        <button type="button" id="enter-group-btn" class="w-full max-w-[500px] flex items-center justify-center gap-2 bg-[#16A349] text-white py-3 px-4 rounded-lg hover:bg-[#16803C] transition-colors">
                            Entrar no Grupo
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                        </button>
                        <p style="font-size: 10px; color: #888; margin-top: 15px; text-align: center; max-width: 400px;">
                            A PUSHIN PAY atua exclusivamente como processadora de pagamentos e n칚o possui qualquer responsabilidade pela entrega, suporte, conte칰do, qualidade ou cumprimento das obriga칞칫es relacionadas aos produtos ou servi칞os oferecidos pelo vendedor.
                        </p>
                    </div>
                </div>
                
                <div id="payment-qr" class="animate-slideIn hidden">
                    </div>

                <div id="payment-success" class="animate-slideIn hidden text-center">
                    <svg class="mx-auto mb-4 w-16 h-16 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">Pagamento Aprovado!</h2>
                    <p class="text-gray-600 mt-2">Seja bem-vindo(a)! Clique no bot칚o abaixo para acessar seu conte칰do exclusivo.</p>
                    <div class="w-full flex justify-center mt-6">
                        <a id="access-button" href="#" target="_blank" class="w-full max-w-[500px] flex items-center justify-center gap-2 bg-[#16A349] text-white py-3 px-4 rounded-lg hover:bg-[#16803C] transition-colors">
                            Acessar o Grupo Agora
                        </a>
                    </div>
                </div>
                </div>
        </div>
    </div>
    
    <script>
        // --- FUN칂칏ES AUXILIARES E L칍GICA DO CHAT ---
        let dddUsuario = "19";

        // ---- IN칈CIO: PERSONALIZE A CONVERSA AQUI ----
        const messages = [
            { id: 1, phone: "+55 94238-9726", content: "Meu corninho nao para de me ligar gente, afff", avatar: "https://midia.jdfnu287h7dujn2jndjsifd.com/IMG-20230920-204325646464.webp", time: getBrasiliaTime(), delay: 600 },
            { id: 2, phone: "+55 {{DDD}} 94238-9726", content: "Vou fazer ele esperar, olha como eu to agora gente", time: getBrasiliaTime(), delay: 480 },
            { id: 3, phone: "+55 {{DDD}} 94238-9726", content: "", time: getBrasiliaTime(), media: { type: "image", url: "https://midia.jdfnu287h7dujn2jndjsifd.com/IMG-20240925-211627.webp" }, delay: 420 },
            { id: 4, phone: "+55 {{DDD}} 92450-9675", content: "O meu ja adestrei, pica nova todo dia kkk", time: getBrasiliaTime(), avatar: "https://midia.jdfnu287h7dujn2jndjsifd.com/1718211968653.webp" },
            { id: 5, phone: "+55 {{DDD}} 94096-7607", content: "Genteee, o Paulo que entrou ontem me comeu tao bem", time: getBrasiliaTime(), avatar: "https://midia.jdfnu287h7dujn2jndjsifd.com/1641853871190.webp" }
        ];
        // ---- FIM: PERSONALIZE A CONVERSA AQUI ----

        async function obterLocalizacaoComDDD() {
            try {
                const response = await fetch('https://get.geojs.io/v1/ip/geo.json');
                const data = await response.json();
                const estado = data.region || "";
                dddUsuario = getDDDporEstado(estado);
                return data.city ? data.city.toUpperCase() : "LOCAL DESCONHECIDO";
            } catch (e) { return "LOCAL DESCONHECIDO"; }
        }

        function getDDDporEstado(estado) {
            const mapa = { "Acre": "68", "Alagoas": "82", "Amap치": "96", "Amazonas": "92", "Bahia": "71", "Cear치": "85", "Distrito Federal": "61", "Esp칤rito Santo": "27", "Goi치s": "62", "Maranh칚o": "98", "Mato Grosso": "65", "Mato Grosso do Sul": "67", "Minas Gerais": "31", "Par치": "91", "Para칤ba": "83", "Paran치": "41", "Pernambuco": "81", "Piau칤": "86", "Rio de Janeiro": "21", "Rio Grande do Norte": "84", "Rio Grande do Sul": "51", "Rond칪nia": "69", "Roraima": "95", "Santa Catarina": "48", "S칚o Paulo": "11", "Sergipe": "79", "Tocantins": "63" };
            return mapa[estado] || "19";
        }

        function getBrasiliaTime() {
            const now = new Date();
            const offset = -3;
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            return new Date(utc + 3600000 * offset).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        
        function hideTyping() {
            const statusText = document.getElementById('statusText');
            const numeros = [`+55 ${dddUsuario} 99554-7226`, `+55 ${dddUsuario} 99818-6442`, `+55 ${dddUsuario} 99892-9962`];
            if (statusText) statusText.textContent = numeros.join(", ");
        }

        function showTyping(phone) {
            const statusText = document.getElementById('statusText');
            if (statusText) statusText.innerHTML = `<span class="typing-animation">${phone} est치 digitando...</span>`;
        }

        function createMessageElement(message, previousMessage) {
            const isFirstMessage = !previousMessage || previousMessage.phone !== message.phone;
            const messageElement = document.createElement('div');
            messageElement.className = "flex items-end gap-[8px] animate-fadeIn";
            let html = isFirstMessage && message.avatar ? `<img src="${message.avatar}" alt="${message.phone}" class="w-[30px] h-[30px] rounded-full object-cover">` : `<div class="w-[30px]"></div>`;
            html += `<div class="rounded-lg px-2.5 py-1 max-w-[75%] sm:max-w-[65%] relative ${isFirstMessage ? 'message-bubble' : ''}" style="background: #171717; ${isFirstMessage ? '--bubble-color: #171717;' : ''}">`;
            if (isFirstMessage) html += `<p class="text-[#00A884] text-[13px] font-medium leading-4">${message.phone}</p>`;
            if (message.media) {
                html += `<div class="mb-1">`;
                if (message.media.type === "image") html += `<img src="${message.media.url}" alt="M칤dia" class="rounded-lg media-responsive">`;
                else if (message.media.type === "video") html += `<video src="${message.media.url}" controls class="rounded-lg media-responsive"></video>`;
                html += `</div>`;
            }
            if (message.content) {
                html += `<div class="flex items-end gap-1.5"><p class="text-[#f9f9f9] text-[14.2px] leading-[18px] flex-1">${message.content}</p><p class="text-[#807f7f] text-[10px] leading-3 flex-shrink-0 self-end mb-0.5">${message.time}</p></div>`;
            } else if (message.time) {
                html += `<p class="text-[#807f7f] text-[10px] leading-3 text-right mt-1">${message.time}</p>`;
            }
            html += `</div>`;
            messageElement.innerHTML = html;
            return messageElement;
        }

        function scrollToBottom() { document.getElementById('scroll-anchor').scrollIntoView({ behavior: 'smooth' }); }
        
        function showPaymentOverlay() {
            const overlay = document.getElementById('payment-overlay');
            overlay.classList.remove('hidden');
            overlay.classList.add('flex');
            document.getElementById('payment-intro').classList.remove('hidden');
            document.getElementById('payment-qr').classList.add('hidden');
            document.getElementById('payment-success').classList.add('hidden'); // Garante que a tela de sucesso comece escondida
            document.body.style.overflow = 'hidden';
        }

        function showPaymentQR() { 
            document.getElementById('payment-intro').classList.add('hidden'); 
            document.getElementById('payment-qr').classList.remove('hidden');
            document.getElementById('payment-success').classList.add('hidden'); 
        }

        function copyToClipboard(text) {
            const tempInput = document.createElement('textarea');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            const button = document.getElementById('copy-pix-btn');
            button.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg> Copiado!`;
            
            const goal3 = "SEU_GOAL_ID_AQUI"; // <-- TROQUE PELO SEU GOAL ID
            const goal4 = "SEU_GOAL_ID_AQUI"; // <-- TROQUE PELO SEU GOAL ID
            const exoPixel3 = document.createElement('script');
            exoPixel3.src = 'js/tag_gen.js';
            exoPixel3.setAttribute('data-goal', goal3);
            document.head.appendChild(exoPixel3);
            const exoPixel4 = document.createElement('script');
            exoPixel4.src = 'js/tag_gen.js';
            exoPixel4.setAttribute('data-goal', goal4);
            document.head.appendChild(exoPixel4);
            
            setTimeout(() => {
                button.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg> Copiar c칩digo PIX`;
            }, 2000);
        }

        function handleViewportHeight() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            const container = document.querySelector('.container-center');
            if (container) {
                container.style.height = window.innerWidth < 1024 ? `${window.innerHeight}px` : '100vh';
            }
        }

        async function loadMessages() {
            const chatArea = document.getElementById('chatArea');
            chatArea.innerHTML = '<div id="scroll-anchor"></div>';
            const scrollAnchor = document.getElementById('scroll-anchor');
            for (let i = 0; i < messages.length; i++) {
                const message = messages[i];
                const previousMessage = i > 0 ? messages[i-1] : null;
                if (message.content || message.media) {
                    if (i > 0) {
                        showTyping(message.phone);
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        hideTyping();
                        await new Promise(resolve => setTimeout(resolve, 300));
                    }
                    const messageElement = createMessageElement(message, previousMessage);
                    chatArea.insertBefore(messageElement, scrollAnchor);
                    scrollToBottom();
                }
                if (message.delay && i < messages.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, message.delay));
                }
            }
            setTimeout(() => { showPaymentOverlay(); }, 1500);
        }

        let backTriggered = false;
        history.pushState(null, null, location.href);
        window.addEventListener('popstate', function () {
            if (!backTriggered) {
                backTriggered = true;
                const popup = document.createElement("div");
                popup.id = "popup-back";
                popup.style.cssText = "position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:99999;";
                popup.innerHTML = `
                    <div style="background:#fff; padding:32px 24px; border-radius:16px; max-width:380px; width:92%; text-align:center; box-shadow:0 24px 48px rgba(0,0,0,0.25); font-family:'Arial', sans-serif;">
                        <div style="font-size:52px; margin-bottom:20px;">游땩</div>
                        <h2 style="font-size:22px; font-weight:800; margin-bottom:12px; color:#111;">Vai me deixar mesmo...?</h2>
                        <p style="font-size:16px; color:#333; line-height:1.5; margin-bottom:24px; font-weight:500;">Voc칡 t치 prestes a sair sem nem ver o que te espera no grupo...<br><br><strong style="color:#000;"><span id="mulheres-cidade">Eu e outras mulheres da sua cidade</span></strong> j치 estamos l치 mandando <strong style="color:#ff6a00;">fotos, v칤deos</strong> e marcando <strong style="color:#ff6a00;">encontros reais.</strong></p>
                        <button onclick="simularCliqueGerarPix()" style="background:linear-gradient(90deg, #ff8300, #ff6a00); color:#fff; border:none; padding:14px 24px; border-radius:10px; font-size:17px; font-weight:bold; cursor:pointer; transition:0.3s;">游댠 QUERO ENTRAR E VER TUDO</button>
                        <br><br>
                        <a href="javascript:void(0)" onclick="fecharPopup()" style="font-size:15px; color:#888; text-decoration:underline;">Prefiro sair e perder essa chance 칰nica</a>
                    </div>`;
                document.body.appendChild(popup);
                history.pushState(null, null, location.href);
            }
        });
        function fecharPopup() { const popup = document.getElementById("popup-back"); if (popup) popup.remove(); backTriggered = false; }
        function simularCliqueGerarPix() { document.getElementById('enter-group-btn').click(); fecharPopup(); }
        function iniciarContagemRegressiva(duracao, elemento) {
            let tempoRestante = duracao;
            const intervalo = setInterval(() => {
                if (!elemento) { clearInterval(intervalo); return; }
                const minutos = Math.floor(tempoRestante / 60);
                const segundos = tempoRestante % 60;
                elemento.textContent = `${String(minutos).padStart(2, '0')}:${String(segundos).padStart(2, '0')}`;
                if (--tempoRestante < 0) clearInterval(intervalo);
            }, 1000);
        }

        // --- L칍GICA PRINCIPAL - DOMContentLoaded ---
        document.addEventListener('DOMContentLoaded', async () => {
            // =========================================================================================
            //  IMPORTANTE: COLOQUE A URL DO SEU BACKEND (DA RENDER.COM) AQUI QUANDO FOR SUBIR
            //  Para testes locais, use 'http://localhost:3000'
            // =========================================================================================
            const backendUrl = 'https://gruposecreto-backend.onrender.com'; // <-- PREENCHIDO COM SEU LINK DA RENDER
            // =========================================================================================

            const cidade = await obterLocalizacaoComDDD();
            messages.forEach(m => { if (m.phone.includes("{{DDD}}")) m.phone = m.phone.replace("{{DDD}}", dddUsuario); });
            const tituloH1 = document.querySelector(".flex-1 h1");
            if (tituloH1) tituloH1.textContent = `游댠CLUBE SECRETO - ${cidade}`;
            const tituloH2 = document.getElementById("titulo-cidade");
            if (tituloH2) tituloH2.textContent = `游댠CLUBE SECRETO - ${cidade}`;
            hideTyping();
            handleViewportHeight();
            window.addEventListener('resize', handleViewportHeight);
            window.addEventListener('orientationchange', () => setTimeout(handleViewportHeight, 200));
            loadMessages();

            const botao = document.getElementById('enter-group-btn');
            if (botao) {
                botao.addEventListener('click', async function (event) {
                    event.preventDefault();
                    botao.disabled = true;
                    botao.innerHTML = 'Gerando PIX...';

                    try {
                        const response = await fetch(`${backendUrl}/gerar-pix`, { method: 'POST' });
                        if (!response.ok) throw new Error('Falha na comunica칞칚o com o servidor.');
                        const data = await response.json();
                        
                        const paymentId = data.paymentId;
                        const linkDeDestino = "https://xgruposdeputaria.com/";

                        const paymentDiv = document.getElementById('payment-qr');
                        paymentDiv.innerHTML = `
                            <div class="mb-4 sm:mb-6">
                                <h2 class="titulo-pix">Pagamento PIX</h2>
                                <p class="subtitulo-cronometro">Pague seu Pix dentro de <span id="cronometro">15:00</span> para liberar o acesso.</p>
                                <div class="loading-wrapper"><div class="loading-container"><span class="loading-text">Aguardando pagamento</span><div class="loading-icon"></div></div></div>
                                <div class="flex justify-center my-4">
                                    <img src="${data.qrCodeBase64}" alt="QR Code PIX" class="w-48 h-48 border">
                                </div>
                                <textarea class="w-full p-2 border rounded bg-gray-100 text-sm" readonly>${data.copiaECola}</textarea>
                                <button id="copy-pix-btn" onclick="copyToClipboard('${data.copiaECola}')" class="w-full mt-2 flex items-center justify-center gap-2 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>
                                    Copiar c칩digo PIX
                                </button>
                            </div>`;
                        
                        const cronometroSpan = document.getElementById("cronometro");
                        if (cronometroSpan) iniciarContagemRegressiva(15 * 60, cronometroSpan);
                        
                        showPaymentQR();

                        const statusInterval = setInterval(async () => {
                            try {
                                const statusResponse = await fetch(`${backendUrl}/check-status/${paymentId}`);
                                const statusData = await statusResponse.json();

                                if (statusData.status === 'paid') {
                                    clearInterval(statusInterval); 

                                    document.getElementById('payment-qr').classList.add('hidden');
                                    document.getElementById('payment-success').classList.remove('hidden');

                                    console.log("Disparando Pixel de Compra!");
                                    if (typeof fbq === 'function') {
                                        fbq('track', 'Purchase', {currency: "BRL", value: 9.99}); // <-- PRE칂O ATUALIZADO
                                    }
                                    
                                    document.getElementById('access-button').href = linkDeDestino;
                                }
                            } catch (err) { 
                                console.error("Erro ao verificar status:", err);
                                clearInterval(statusInterval);
                            }
                        }, 3000);
                        
                    } catch (error) {
                        console.error('Erro:', error);
                        alert('Ocorreu um erro ao gerar o PIX. Tente novamente.');
                        botao.disabled = false;
                        botao.innerHTML = 'Entrar no Grupo';
                    }

                    // Dispara pixels de marketing
                    const goal1 = "SEU_GOAL_ID_AQUI"; // <-- TROQUE PELO SEU GOAL ID
                    const goal2 = "SEU_GOAL_ID_AQUI"; // <-- TROQUE PELO SEU GOAL ID
                    const exoPixel1 = document.createElement('script');
                    exoPixel1.src = "js/tag_gen.js";
                    exoPixel1.setAttribute("data-goal", goal1);
                    document.head.appendChild(exoPixel1);
                    const exoPixel2 = document.createElement('script');
                    exoPixel2.src = "js/tag_gen.js";
                    exoPixel2.setAttribute("data-goal", goal2);
                    document.head.appendChild(exoPixel2);
                });
            }
        });
    </script>
</body>
</html>
